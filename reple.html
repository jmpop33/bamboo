<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì‹œí—˜ í›„ ë¦¬í”Œë ‰ì…˜</title>

<style>
:root{
  --main:#1f2937;
  --accent:#2563eb;
  --bg:#f3f4f6;
  --card:#ffffff;
}

*{ box-sizing:border-box; }

body{
  margin:0;
  font-family: "Segoe UI", Arial, sans-serif;
  background:var(--bg);
}

header{
  background:var(--main);
  color:white;
  padding:18px;
  text-align:center;
}

.container{
  max-width:880px;
  margin:20px auto;
  padding:0 15px;
}

.box{
  background:var(--card);
  padding:18px;
  border-radius:12px;
  margin-bottom:18px;
  box-shadow:0 6px 18px rgba(0,0,0,0.06);
}

h3{
  margin:0 0 12px;
  color:var(--main);
}

label{
  font-weight:600;
  margin-top:10px;
  display:block;
}

input, select, textarea{
  width:100%;
  padding:10px;
  margin-top:6px;
  border-radius:8px;
  border:1px solid #ddd;
  font-size:14px;
}

textarea{ min-height:80px; }

.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}

.check{
  background:#f9fafb;
  padding:10px;
  border-radius:8px;
  display:flex;
  align-items:center;
  gap:8px;
}

.saved{
  margin-top:8px;
  font-size:12px;
  color:green;
}

.analysis{
  font-size:14px;
  line-height:1.6;
  margin-top:8px;
}
</style>
</head>

<body>

<header>
  <h2>ğŸ“ ì‹œí—˜ í›„ ë¦¬í”Œë ‰ì…˜</h2>
  <div style="font-size:12px;">ëª¨ë“  ì…ë ¥ ë‚´ìš©ì€ ìë™ ì €ì¥ë©ë‹ˆë‹¤</div>
</header>

<div class="container">

<div class="box">
  <div class="grid">
    <div>
      <label>ê³¼ëª©</label>
      <select id="subject">
        <option>ìˆ˜í•™</option>
        <option>êµ­ì–´</option>
        <option>ì˜ì–´</option>
        <option>ê³¼í•™</option>
        <option>ì‚¬íšŒ</option>
      </select>
    </div>
    <div>
      <label>ì‹œí—˜ ì¢…ë¥˜</label>
      <select id="examType">
        <option>ì¤‘ê°„ê³ ì‚¬</option>
        <option>ê¸°ë§ê³ ì‚¬</option>
        <option>ëª¨ì˜ê³ ì‚¬</option>
      </select>
    </div>
  </div>

  <div class="grid">
    <div>
      <label>ì˜ˆìƒ ì ìˆ˜</label>
      <input type="number" id="expected">
    </div>
    <div>
      <label>ì‹¤ì œ ì ìˆ˜</label>
      <input type="number" id="actual">
    </div>
  </div>

  <label>ì²´ê° ë‚œì´ë„</label>
  <input type="range" min="1" max="5" id="difficulty">
</div>

<div class="box">
  <h3>âš ï¸ ì‹œí—˜ ì¤‘ ì‹¤ìˆ˜ ìœ í˜•</h3>
  <div class="grid">
    <label class="check"><input type="checkbox" data-key="mistake"> ê³„ì‚° ì‹¤ìˆ˜</label>
    <label class="check"><input type="checkbox" data-key="mistake"> ë¬¸ì œ í•´ì„ ì˜¤ë¥˜</label>
    <label class="check"><input type="checkbox" data-key="mistake"> ì‹œê°„ ë¶€ì¡±</label>
    <label class="check"><input type="checkbox" data-key="mistake"> ê¸´ì¥ìœ¼ë¡œ ì¸í•œ ì‹¤ìˆ˜</label>
  </div>
</div>

<div class="box">
  <label>ğŸš€ ë‹¤ìŒ ì‹œí—˜ ê°œì„  ì „ëµ</label>
  <textarea id="plan"></textarea>
</div>

<div class="box">
  <h3>ğŸ“Š ìë™ ë¶„ì„ ê²°ê³¼</h3>
  <div id="analysis" class="analysis"></div>
  <div class="saved" id="savedMsg"></div>
</div>

</div>
  <button onclick="location.href='main.html'">ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>

<script>
const inputs = document.querySelectorAll("input, textarea, select");
const key = "reflection_auto";

function save(){
  const data = {};
  let filled = 0;

  inputs.forEach(el=>{
    if(el.type==="checkbox"){
      if(!data[el.dataset.key]) data[el.dataset.key]=[];
      if(el.checked) data[el.dataset.key].push(el.parentElement.innerText.trim());
    } else {
      data[el.id]=el.value;
      if(el.value) filled++;
    }
  });

  localStorage.setItem(key, JSON.stringify(data));
  analyze(data, filled);
  savedMsg.innerText="âœ” ìë™ ì €ì¥ë¨";
  setTimeout(()=>savedMsg.innerText="",1200);
}

function analyze(data, filled){
  let result = "";

  if(data.expected && data.actual){
    const diff = data.actual - data.expected;
    result += `<b>ğŸ“ˆ ì ìˆ˜ ë¶„ì„</b><br>`;
    if(Math.abs(diff)<=5) result += "ğŸ¯ ìê¸° í‰ê°€ ì •í™•<br>";
    else if(diff<0) result += "âš ï¸ ì˜ˆìƒë³´ë‹¤ ë‚®ìŒ â†’ ì‹¤ìˆ˜/ë‚œì´ë„ íŒë‹¨ í•„ìš”<br>";
    else result += "ğŸ‘ ì˜ˆìƒë³´ë‹¤ ë†’ìŒ â†’ ì‹¤ë ¥ ê³¼ì†Œí‰ê°€ ê²½í–¥<br>";
  }

  if(data.mistake?.length){
    result += `<br><b>ğŸ›  ê°œì„  ì „ëµ</b><br>`;
    if(data.mistake.includes("ê³„ì‚° ì‹¤ìˆ˜")) result += "- ê³„ì‚° ì „ìš© ë¬¸ì œ ë°˜ë³µ ì—°ìŠµ<br>";
    if(data.mistake.includes("ì‹œê°„ ë¶€ì¡±")) result += "- ì‹œê°„ ì œí•œ ë¬¸ì œ í’€ì´ í›ˆë ¨<br>";
    if(data.mistake.includes("ë¬¸ì œ í•´ì„ ì˜¤ë¥˜")) result += "- ë¬¸ì œ ì¡°ê±´ í‘œì‹œ ìŠµê´€í™”<br>";
    if(data.mistake.includes("ê¸´ì¥ìœ¼ë¡œ ì¸í•œ ì‹¤ìˆ˜")) result += "- ì‹¤ì „ ëª¨ì˜ ì—°ìŠµ í•„ìš”<br>";
  }

  const percent = Math.round((filled/7)*100);
  result += `<br><b>ğŸ“Œ ë¦¬í”Œë ‰ì…˜ ì™„ì„±ë„</b>: ${percent}%`;

  analysis.innerHTML = result;
}

inputs.forEach(el=>{
  el.addEventListener("input",save);
  el.addEventListener("change",save);
});

(function load(){
  const data = JSON.parse(localStorage.getItem(key)||"{}");
  inputs.forEach(el=>{
    if(el.type==="checkbox"){
      el.checked = data[el.dataset.key]?.includes(el.parentElement.innerText.trim());
    } else {
      el.value = data[el.id] || "";
    }
  });
  save();
})();
  window.onload = () => {
    const isLogin = sessionStorage.getItem("login"); 
    if (isLogin !== "true") {
      alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤");
      location.href = "login.html";
  }}
</script>

</body>
</html>
